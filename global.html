<!--
/***************************************
 * @file global.html
 * @author Travis Roman (travis@toggleable.com)
 * @package JavaScript Blocker (http://javascript-blocker.toggleable.com)
 ***************************************/
-->

<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8" />
		
		<title>JavaScript Blocker</title>
		
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
		<script src="js/beautify.min.js"></script>
		<script src="i18n/i18n.js"></script>
		<script src="i18n/en-us.js"></script>
		<script src="js/poppy.js"></script>
		<script src="js/global.js"></script>
		<script src="js/poppies.js"></script>
		<script src="js/predefined.js"></script>

		<script>
			document.addEventListener('DOMContentLoaded', function () {
				JavaScriptBlocker.load_language();
			});

			window.addEventListener('message', function (event) {
				if (event.source === window && event.data === 'zero-timeout') {
					event.stopPropagation();
					if (JavaScriptBlocker.utils._zero_timeouts.length) {
						var o = JavaScriptBlocker.utils._zero_timeouts.shift();
						if (typeof o[0] === 'function')
							o[0].apply(JavaScriptBlocker, o[1]);
					}
				}
			}, true);
			
			safari.application.addEventListener('close', $.proxy(JavaScriptBlocker.open_popover, JavaScriptBlocker), true);
			safari.application.addEventListener('beforeNavigate', $.proxy(JavaScriptBlocker.open_popover, JavaScriptBlocker), true);
			safari.application.addEventListener('popover', $.proxy(JavaScriptBlocker.open_popover, JavaScriptBlocker), true);
			safari.application.addEventListener('validate', $.proxy(JavaScriptBlocker.validate, JavaScriptBlocker), false);
			safari.application.addEventListener('message', $.proxy(JavaScriptBlocker.handle_message, JavaScriptBlocker), true);
			safari.extension.settings.addEventListener('change', $.proxy(JavaScriptBlocker.setting_changed, JavaScriptBlocker), true);
		</script>
	</head>
</html>