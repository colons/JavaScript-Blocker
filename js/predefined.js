/***************************************
 * @file js/predefined.js
 * @author Travis Roman (travis@toggleable.com)
 * @package JavaScript Blocker (http://javascript-blocker.toggleable.com)
 ***************************************/

var def = [
'/xtcore.js',
'/?livehit=',
'/?record&key=',
'/__utm.gif',
'/a.logrequest.yolx?',
'/aa.php?anuid=',
'/add_page_view?',
'/adlogger_tracker.js?',
'/adlogger_tracker.php',
'/afrpt.gif?',
'/aggbug.aspx?',
'/analysis-logger/logger?',
'/analyzer/aa.php?',
'/aspstats/index.asp?',
'/astrack.js',
'/astracker.js',
'/atapixel.js',
'/awstats.js',
'/awstats_misc_tracker.js',
'/b/ss/*&ce=iso-8859-1&',
'/b/ss/*&ce=utf-8&',
'/b/ss/*&events=',
'/b/ss/*&pagename=',
'/b/ss/*=event36&',
'/b/ss/*=referrers&',
'/b/ss/*?[aqb]&ndh=',
'/b/ss/*?aqb=1&ndh=',
'/b/ss/*?aqb=1&pccr=',
'/b/ss/*?pagename=',
'/b/ss/ueglobaldev/*',
'/b/ss/wdgdolad,',
'/baynote-observer.js',
'/baynote-search.js',
'/baynote-single-local.js',
'/baynote.js',
'/baynoteobserver/*',
'/beacon?',
'/bh_counter.js',
'/bluekai.js',
'/bm-analytics-trk.js',
'/bsuite/worker.php?',
'/cdn5.js?',
'/cdx.gif?',
'/cedexis.js',
'/cedexis/*',
'/certifica-js14.js',
'/certifica.js',
'/certifica_2010.js',
'/cgi-bin/count.cgi?*df=',
'/cgi-bin/count.cgi?*ft=',
'/cgi-bin/count.cgi?*rgb=',
'/cgi-bin/count.cgi?*sh=',
'/cgi-bin/ctasp-server.cgi?',
'/cgi-bin/ivw-ssl/*',
'/cgi-bin/ivw/*',
'/cgi-bin/online/uos.cgi?',
'/cgi-bin/pagedot.gif?',
'/cgi-bin/user_online/uos.cgi?',
'/cgi-bin/vdz/cp/*',
'/cgi-sys/count.cgi?df=',
'/ch/additional.php?res_width=',
'/chartbeat.js',
'/chcounter/*',
'/clickheat.js',
'/clickheat/*',
'/clickstream.js',
'/cm?ci=*&tid=',
'/cm?tid=',
'/cnstats/cntg.php?',
'/cnt-combined.php?',
'/com_astatspro/*',
'/com_joomla-visites/*',
'/com_joomlawatch/*',
'/comscore.js',
'/comscore_beacon.js',
'/count/additional.php?res_width=',
'/counter.php?chcounter_mode=',
'/counter/additional.php?res_width=',
'/csi?v=*&action=',
'/dcs.gif?',
'/demandbase.js',
'/dotomi_tracking/*',
'/dtmtag.js',
'/e086ec.aspx?q=l3mkwgak',
'/e107_plugins/log/log.php?',
'/eae-logger/*',
'/econa-site-search-ajax-log-referrer.php',
'/edata.js',
'/elqcfg-$script',
'/elqcfg.js',
'/elqimg.js',
'/elqnow/*',
'/eluminate?',
'/emos2.js',
'/estatnativeflashtag.swf',
'/event.ng/*',
'/finalizestats.js',
'/firestats/*.php?*site_id=',
'/fkounter/*',
'/fkounter5/*',
'/foresee/*',
'/fpc.pl?a=',
'/fpcount.exe',
'/fsrscripts/*',
'/ga.aspx?utmac=$image',
'/ga.php?utmac=$image',
'/ga_social_tracking.js',
'/gaaddons.js',
'/gapro-1.swf',
'/gapro.swf',
'/gatag.js',
'/gatc.js',
'/gcount.pl?',
'/gemius.js',
'/gemius/*',
'/getsidpixeltag?sid=',
'/globalpagetracking.js',
'/google-analyticator/*',
'/google-analytics-for-wordpress/*',
'/googleanalytics-prod.swf',
'/googleanalytics.swf',
'/googleanalytics/ga.php?$image',
'/googleanalyticsmanagement.swf',
'/googleanalyticsplugin.swf',
'/headupstats.gif?',
'/heatmap.js',
'/heatmap_log.js',
'/hg?hc=&hb=*&vjs=',
'/hgct?hc=&hb=*&vjs=',
'/hitcounter.dll',
'/i?siteid=',
'/images/spacer.gif?q=l3mkwgak',
'/index.php?_m=livesupport*&referrer=',
'/intervigil.js',
'/iperceptions.js',
'/ipixel?spacedesc=',
'/iqtm.js',
'/istat.aspx?',
'/ivwanalytics.swf?',
'/ivwbox/*',
'/js/tagging/tagtrack.js',
'/kaizentrack/*',
'/kelkooid?sitename=',
'/kissmetrics.js',
'/kissmetrics/*',
'/layer_log.php?p=',
'/leadgen_tracking.js',
'/library/svy/*/broker.js',
'/library/svy/broker.js',
'/linkinformer.js',
'/livezilla/server.php?request=track&',
'/log_e.php?id=',
'/logaholictracker.php?',
'/logger/p.gif?',
'/logger?*ctxid=',
'/logreferrer.php?*&referrer=',
'/md.js?country=',
'/mdwtc/click_thru/*',
'/metriweb.js',
'/mint/?js',
'/mintstats/?js',
'/mmcore.js',
'/mngi/tracking/*',
'/modules/contrib/google_analytics/*',
'/modules/contributions/google_analytics/*',
'/modules/google_analytics/*',
'/modules/google_analytics_event_tracking/*',
'/msftaudience.js',
'/mtvi_reporting.js',
'/mwtag.js',
'/mwtag_flash.js',
'/myasg/stats_js.asp',
'/mycounter/additional.php?res_width=',
'/mycounter/counter_in.php?',
'/mystats/track.js',
'/netmind-$script',
'/netupdate/live.php?',
'/nielsen.js',
'/nielsen/*',
'/nielsenscv53.$script',
'/nielson_stats.js',
'/njs.gif?',
'/nm_tr_combined-min.js',
'/nm_tr_combined.js',
'/nm_track.js',
'/nm_trck.gif?',
'/ntpagetag.gif',
'/ntpagetag.js',
'/ntrack.asp?',
'/oas_analytics.js',
'/odoscope.js',
'/omnidiggthis|',
'/omnitureanalytics.swf?',
'/onestat.js',
'/opinionlab.js',
'/pagelogger/connector.php?',
'/pbstrackingplugin.swf',
'/php-stats.js.php',
'/php-stats.php?',
'/php-stats.phpjs.php?',
'/php-stats.recjs.php?',
'/phpmyvisites.js',
'/piwik.js',
'/piwik.php',
'/pixelstats/*',
'/planetstat.php?',
'/plugins/google-analytics/*',
'/pphlogger.js',
'/pphlogger.php',
'/pr.php?',
'/prnx_track.js',
'/quant.js',
'/quantcast.js',
'/rbipt.gif?',
'/rbipt.js',
'/rcdntpagetag.js',
'/redirectexittrack.php?',
'/remote/js_logger.php',
'/revenuescience.js',
'/revsci.js',
'/s.gif?l=',
'/sdctag.js?',
'/sdxp1/dru4/meta?_hc=',
'/server.php?request=track&output=',
'/shinystat.cgi?',
'/sitestat.js',
'/sitestats.gif?',
'/sitetrek.js',
'/slimstat/*',
'/softpage/stats_registerhit.asp?',
'/sophus/logging.js',
'/sophus3/logging-code.js',
'/sophus3/logging.js',
'/sophus3_logging.js',
'/staffcp/save_stats.php?',
'/stat/track.php?mode=js',
'/stat36/stat/track.php',
'/stataffs/track.php?',
'/statcounter.js',
'/statcountex/count.asp?',
'/stateye/*',
'/stats/additional.php?res_width=',
'/stats/et_track.asp?',
'/stats/track.asp?',
'/stats/tracker.gif?',
'/statsadvance.js',
'/statscript.js',
'/stwc-counter/*',
'/stwc/code.js',
'/swfaddress.js?tracker=',
'/tacoda_ams_ddc_header.js',
'/tagomnitureengine.js',
'/tc_logging.js',
'/tc_targeting.html',
'/tc_throttle.js',
'/tnsmetrix/*',
'/touchclarity/*',
'/tpix.gif?',
'/track/*?rnd=0.$image',
'/tracker/event?',
'/tracking/tynt_',
'/traffic/?',
'/traffic/status.gif?',
'/traffic4u.js',
'/tsc.php?*&ses=',
'/userfly.js',
'/viperbar/stats.php?',
'/visualsciences.js',
'/visualstat/stat.php',
'/vstats/counter.php',
'/vtrack.php?',
'/webabacus-$script',
'/webforensics/*',
'/webiq.js',
'/webstatistik/track.asp',
'/webtraxs.js',
'/webtrekk.js',
'/webtrekk_',
'/where-go-add.js.php?',
'/who/?js',
'/whoson_*_trackingonly.js',
'/wlexpert_tracker.',
'/wlexpert_tracker/*',
'/wp-clickmap/*',
'/wp-content/plugins/stats/count.php?',
'/wp-counter.php',
'/wp-js/analytics.js?',
'/wp-powerstat/*',
'/wp-slimstat/*',
'/wt_capi.js',
'/wtbase.js',
'/wtcore.js',
'/wtid.js',
'/wtinit.js',
'/wusage_screen_properties.gif?',
'/wysistat.js',
'/xgemius.js',
'/xiti.js',
'/xtclicks-$script',
'/xtclicks.js',
'/xtcore.js',
'/xtrack.php?',
'/xtroi.js',
'/yalst/pixel*.php?',
'/zaehler/additional.php?res_width=',
'/zag.gif?',
'/~utm_gif?'];

def = def.map(function (v) { return JB.utils.escape_regexp(v).replace(/\\\*/g, '.*'); });

/* ====================WHITELIST===================== */

var wld = {
	script: {
		'.*': [
			'www\\.readability\\.com',
			'seal\\.verisign\\.com',
		],
		'.amazon.com': ['(ssl\\-)?images\\-amazon\\.com'],
		'.reddit.com': ['www\\.redditstatic\\.com'],
		'.paypal.com': ['www\\.paypalobjects\\.com'],
		'.google.com': ['gstatic\\.com'],
		'.youtube.com': ['ytimg\\.com', 'clients[0-9]+\\.google\\.com'],
		'.readability.com': ['cloudfront\\.net'],
		'.icloud.com': ['gstatic\\.com'],
		'.monster.com': ['monster\\.com'],
		'.ensighten.com': ['ensighten\\.com'],
		'.gorillanation.com': ['gorillanation\\.com']
	},
	frame: {
		'.facebook.com': ['facebook\\.com'],
		'.stumbleupon.com': ['.*(All Frames)?']
	},
	embed: {
		'.youtube.com': ['ytimg\\.com']
	},
	image: {
		'.google.com': ['gstatic\\.com']
	}
};

JB.rules.whitelist = {
	script: {
		'.*': [
			'^(Google hosted JavaScript frameworks)?https?:\\/\\/ajax\\.googleapis\\.com\\/ajax\\/libs\\/.*\\.js(\\?.*)?$',
			'^(Google hosted JavaScript frameworks)?https?:\\/\\/www\\.google\\.com\\/jsapi(\\?.*)?$',
			'^(Prototype, the JavaScript framework)?.*\\/prototype\\.js(\\?.*)?$',
			'^(jQuery, the JavaScript framework)?.*\\/jquery(\\-ui)?\\-[1-9]\\.[0-9]+\\.[0-9]+(\\.min)?\\.js(\\?.*)?$',
			'^(jQuery, the JavaScript framework)?.*\\/jquery\\.[^.\\/]+\\.js(\\?.*)?$',
			'^(jQuery, the JavaScript framework)?.*\\/jquery\\.js(\\?.*)?$',
			'^(jQuery UI, the JavaScript framework to make things pretty)?.*\\/jquery(\\-ui|\\.ui)\\.([^.\\/]+)?\\.js$',
			'^(reCAPTCHA)?https?:\\/\\/www\\.google\\.com\\/recaptcha\\/api\\/.*$'
		]
	},
	embed: {
		'.*': [['Used as a placeholder to open movie files in QT Player', 'https?:\\/\\/images\\.apple\\.com\\/apple\-events\\/includes\\/qtbutton\\.mov$']]
	},
	image: {
		'.google.com': [['Some images on Google Images are encoded as data URIs', '^data:.*$']]
	}
};

for (var k in wld) {
	for (var d in wld[k]) {
		if (!(k in JB.rules.whitelist)) JB.rules.whitelist[k] = {};
		if (!(d in JB.rules.whitelist[k])) JB.rules.whitelist[k][d] = [];

		for (var i = 0; wld[k][d][i]; i++)
			JB.rules.whitelist[k][d].push([
				'^', typeof wld[k][d][i] === 'object' ? '(' + wld[k][d][i][0] + ')?' : '',
				'https?:\\/\\/([^\\/]+\.)?', typeof wld[k][d][i] === 'object' ? wld[k][d][i][1] : wld[k][d][i], '\\/.*$'].join(''))	}
}

var wl = JB.rules.whitelist.script;

wl['.google.co.uk'] = wl['.google.com'];
wl['.google.de'] = wl['.google.com'];
wl['.amazon.de'] = wl['.amazon.com'];
wl['.amazon.co.uk'] = wl['.amazon.com'];

/* ====================BLACKLIST===================== */

var bld = {
	script: {
		'.*': [
			['Blocks copy and paste on websites', 'tynt\\.com'],
			['Turns words on webpages into clickable ads', 'kontera\\.com'],
			['Makes a popup appear over a link when hovered on', 'snap\\.com'],
			['User tracking and advertising', '(edge|pixel)\\.quantserve\\.com'],
			['Advertisements', 'pagead[0-9]+\\.googlesyndication\\.com'],
			['Advertisements', 'blogads\\.com'],
			['Advertisements', 'admeld\\.com'],
			['Tracks users', 'scorecardresearch\\.com'],
			['Social media tracking', 'connect\\.facebook\\.(com|net)'],
			['Social media tracking', 'platform\\.twitter\\.com'],
			['Advertisements', 'engine\\.carbonads\\.com'],
			['Adds a "tweet-this" button on webpages', 'widgets\\.twimg\\.com'],
			['Tracks users', 'media6degrees\\.com'],
			['Tracks users', '(ssl|www)\\.google\\-analytics\\.com'],
			['User tracking and advertisements', '(ad|stats)\.([a-z]+\\.)?doubleclick\.net'],
			['Tracks users', 'getclicky\\.com'],
			['Advertisements', 'infolinks\\.com'],
			['Tracks users', 'clicktale\\.(net|com)'],
			['User tracking and advertisements', 'zedo\\.com'],
			['Tracks users', 'monster\\.com'],
			['Tracks users', 'ensighten\\.com'],
			['User tracking and advertisements', 'gorillanation\\.com'],
			['Tracks users', 'bizographics\\.com'],
			['Adds a "digg-this" button on webpages', 'widgets\\.digg\\.com'],
			['Tracks users', 'chartbeat\\.com'],
			['Adds a "reddit-this" button on webpages', 'redditstatic.s3.amazonaws.com'],
			['Adds a "reddit-this" button on webpages', 'reddit.com'],
			['Tracks users', 'verticalacuity\\.com'],
			['Tracks users', 'sail\\-horizon\\.com'],
			['Tracks users', 'kissmetrics\\.com'],
			['Advertisements', 'legolas\\-media\\.com'],
			['Advertisements', 'adzerk\\.(com|net)'],
			['Advertisements', 'adtechus\\.com'],
			['Marketing', 'skimlinks\\.com'],
			['Marketing', 'visualwebsiteoptimizer\\.com'],
			['Marketing', 'marketo\\.(net|com)'],
			['Tracks users', 'coremetrics\\.com'],
			['Tracks users', 'serving\\-sys\\.com'],
			['Advertisements', 'insightexpressai\\.com']
		]
	},
	frame: {
		'.*': [
			['Facebook social media tracking', 'facebook\\.com'],
			['Twitter social media tracking', 'twitter\\.com'],
			['Google social media tracking', 'plusone\\.google\\.(com|ca|co\\.uk)'],
			'ads\\.[^\\.]+\\..*',
			['Tracks users', 'mediaplex\\.com'],
			['Advertisements', 'legolas\\-media\\.com']
		]
	}
};

JB.rules.blacklist = {
	script: { '.*': ['^https?:\\/\\/.*(' + def.join('|') + ').*$'] },
	frame: { '.*': ['^https?:\\/\\/.*(' + def.join('|') + ').*$'] },
	embed: { '.*': ['^https?:\\/\\/.*(' + def.join('|') + ').*$'] }
};


for (var k in bld) {
	for (var d in bld[k]) {
		if (!(k in JB.rules.blacklist)) JB.rules.blacklist[k] = {};
		if (!(d in JB.rules.blacklist[k])) JB.rules.blacklist[k][d] = [];

		for (var i = 0; bld[k][d][i]; i++)
			JB.rules.blacklist[k][d].push([
				'^', typeof bld[k][d][i] === 'object' ? '(' + bld[k][d][i][0] + ')?' : '',
				'https?:\\/\\/([^\\/]+\.)?', typeof bld[k][d][i] === 'object' ? bld[k][d][i][1] : bld[k][d][i], '\\/.*$'].join(''))
	}
}

delete def;
def = undefined;

delete wl;
wl = undefined;

delete wld;
wld = undefined;

delete bld;
bld = undefined;
